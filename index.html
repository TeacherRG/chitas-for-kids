<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <title>◊ë◊¥◊î | –•–∏—Ç–∞—Å –¥–ª—è –≤—É–Ω–¥–µ—Ä–∫–∏–Ω–¥–æ–≤</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="audio-styles.css">

    <!-- Animate.css –¥–ª—è –∫—Ä–∞—Å–∏–≤—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>
<body>
    <!-- –°–∫—Ä—ã—Ç—ã–π audio —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –∑–≤—É–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ -->
    <audio id="audioPermissionTrigger" style="display: none;" preload="auto">
        <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º data URI —Å —Ç–∏—Ö–∏–º –∑–≤—É–∫–æ–º -->
        <source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=" type="audio/wav">
    </audio>

    <header class="app-header">
        <div class="bh-corner">◊ë◊¥◊î</div>
        <h1>üìñ –•–∏—Ç–∞—Å –¥–ª—è –≤—É–Ω–¥–µ—Ä–∫–∏–Ω–¥–æ–≤</h1>
        <p>–ñ–∏—Ç—å –≤ –Ω–æ–≥—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º!</p>
    </header>

    <div class="view active" id="homeView">
        <div class="container">
            <div class="card date-card">
                <h2 id="hebrewDate">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
                <div class="dedication" id="dedication"></div>
            </div>

            <div id="mazelTovSection"></div>

            <div class="card progress-card">
                <div class="progress-stats">
                    <div class="progress-stat">
                        <div class="value" id="scoreValue">0</div>
                        <div class="label">üìä –ë–∞–ª–ª—ã</div>
                    </div>
                    <div class="progress-stat">
                        <div class="value" id="starsValue">0</div>
                        <div class="label">‚≠ê –ó–≤—ë–∑–¥—ã</div>
                    </div>
                    <div class="progress-stat">
                        <div class="value" id="completedValue">0/6</div>
                        <div class="label">‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ</div>
                    </div>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progressBar" style="width: 0%">0%</div>
                </div>
            </div>

            <div class="tiles-grid" id="tilesGrid">
                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</div>
            </div>

            <!-- Date Navigation moved to bottom -->
            <nav class="date-navigation-bottom">
                <button class="btn" id="prevDayBtn">‚óÄ –ü—Ä–µ–¥</button>
                <button class="btn" id="todayBtn">üìÖ –°–µ–≥–æ–¥–Ω—è</button>
                <button class="btn" id="nextDayBtn">–°–ª–µ–¥ ‚ñ∂</button>
            </nav>
        </div>
    </div>

    <div class="view" id="profileView">
        <div class="container">
            <!-- Auth Container -->
            <div class="card auth-card">
                <div id="authContainer"></div>
            </div>

            <!-- –°—Ç—Ä–∏–∫ (–û–≥–æ–Ω—ë–∫) - –ö–†–ò–¢–ò–ß–ù–û -->
            <div class="card streak-card">
                <h2>üî• –¢–≤–æ–π —Å—Ç—Ä–∏–∫</h2>
                <div class="streak-display">
                    <div class="streak-flame" id="streakIcon">üî•</div>
                    <div class="streak-counter">
                        <div class="streak-value" id="currentStreak">0</div>
                        <div class="streak-label">–¥–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
                    </div>
                </div>
            </div>

            <!-- –£—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <div class="card level-card">
                <h2>üìö –¢–≤–æ–π —É—Ä–æ–≤–µ–Ω—å</h2>
                <div class="level-display">
                    <div class="level-icon" id="levelIcon">üìö</div>
                    <div class="level-info">
                        <div class="level-name" id="userLevel">–¢–∞–ª–º–∏–¥</div>
                        <div class="level-progress-text" id="levelProgress">0/7</div>
                    </div>
                </div>
                <div class="level-description">
                    –¢–∞–ª–º–∏–¥ ‚Üí –ë–∞–∫–∫–∏ ‚Üí –õ–∞–º–¥–∞–Ω ‚Üí –†–∞–≤ ‚Üí –ì–∞–æ–Ω
                </div>
            </div>

            <div class="card profile-header">
                <h2>üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
                <div class="profile-stats">
                    <div class="profile-stat">
                        <div class="value" id="totalScore">0</div>
                        <div class="label">üèÜ –í—Å–µ–≥–æ –±–∞–ª–ª–æ–≤</div>
                    </div>
                    <div class="profile-stat">
                        <div class="value" id="totalStars">0</div>
                        <div class="label">‚≠ê –í—Å–µ–≥–æ –∑–≤—ë–∑–¥</div>
                    </div>
                    <div class="profile-stat">
                        <div class="value" id="totalDays">0</div>
                        <div class="label">üìÖ –í—Å–µ–≥–æ –¥–Ω–µ–π</div>
                    </div>
                </div>
            </div>

            <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è - 5 —É—Ä–æ–≤–Ω–µ–π -->
            <div class="card achievements">
                <h2>üéØ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
                <div class="achievement-item">
                    <div class="achievement-icon">ü•á</div>
                    <div class="achievement-info">
                        <h3>–¢–∞–ª–º–∏–¥</h3>
                        <p>7 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥</p>
                    </div>
                    <div class="achievement-status" id="achievement1">üîí</div>
                </div>
                <div class="achievement-item">
                    <div class="achievement-icon">üî•</div>
                    <div class="achievement-info">
                        <h3>–ë–∞–∫–∫–∏</h3>
                        <p>14 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥</p>
                    </div>
                    <div class="achievement-status" id="achievement2">üîí</div>
                </div>
                <div class="achievement-item">
                    <div class="achievement-icon">üéì</div>
                    <div class="achievement-info">
                        <h3>–õ–∞–º–¥–∞–Ω</h3>
                        <p>21 –¥–µ–Ω—å –ø–æ–¥—Ä—è–¥</p>
                    </div>
                    <div class="achievement-status" id="achievement3">üîí</div>
                </div>
                <div class="achievement-item">
                    <div class="achievement-icon">üë®‚Äçüè´</div>
                    <div class="achievement-info">
                        <h3>–†–∞–≤</h3>
                        <p>30 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥</p>
                    </div>
                    <div class="achievement-status" id="achievement4">üîí</div>
                </div>
                <div class="achievement-item">
                    <div class="achievement-icon">‚≠ê</div>
                    <div class="achievement-info">
                        <h3>–ì–∞–æ–Ω</h3>
                        <p>50 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥</p>
                    </div>
                    <div class="achievement-status" id="achievement5">üîí</div>
                </div>
            </div>

            <!-- –ó–Ω–∞—á–∫–∏ –∑–∞ –Ω–µ–¥–µ–ª–∏ -->
            <div class="card weekly-badges">
                <h2>üèÖ –ó–Ω–∞—á–∫–∏ –∑–∞ –Ω–µ–¥–µ–ª–∏</h2>
                <div class="weekly-badge-count">
                    <span id="weeklyBadgesCount">0</span> –Ω–µ–¥–µ–ª—å –∑–∞–≤–µ—Ä—à–µ–Ω–æ
                </div>
                <div id="weeklyBadgesContainer"></div>
            </div>

            <!-- –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —É—Å–ø–µ—Ö–∞–º–∏ -->
            <div class="card share-progress">
                <h2>üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —É—Å–ø–µ—Ö–∞–º–∏</h2>
                <div class="share-buttons">
                    <button class="share-btn whatsapp" id="shareWhatsAppBtn">
                        <span class="share-icon">üí¨</span>
                        WhatsApp
                    </button>
                    <button class="share-btn telegram" id="shareTelegramBtn">
                        <span class="share-icon">‚úàÔ∏è</span>
                        Telegram
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="view" id="helpView">
        <div class="container">
            <div class="card setting-item" data-help-section="about">
                <div class="setting-info">
                    <h3>üìñ –û –ø—Ä–æ–µ–∫—Ç–µ</h3>
                    <p>–£–∑–Ω–∞–π—Ç–µ –±–æ–ª—å—à–µ –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</p>
                </div>
            </div>
            <div class="card setting-item" data-help-section="howto">
                <div class="setting-info">
                    <h3>üéÆ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å</h3>
                    <p>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é</p>
                </div>
            </div>
            <div class="card setting-item" data-help-section="privacy">
                <div class="setting-info">
                    <h3>üîí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</h3>
                    <p>–ü–æ–ª–∏—Ç–∏–∫–∞ –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö</p>
                </div>
            </div>
            <div class="card setting-item" id="contactEmailBtn">
                <div class="setting-info">
                    <h3>‚úâÔ∏è –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</h3>
                    <p>–ü–∏—à–∏—Ç–µ –Ω–∞ office@mychitas.app</p>
                </div>
            </div>
            <div class="card setting-item" id="shareAppBtn">
                <div class="setting-info">
                    <h3>üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</h3>
                    <p>www.mychitas.app</p>
                </div>
            </div>
        </div>
    </div>

    <div class="view" id="aboutView">
        <div class="container">
            <div class="card">
                <button class="btn" id="backToHelpFromAbout" style="margin-bottom: 15px;">‚Üê –ù–∞–∑–∞–¥</button>
                <h2>üìñ –û –ø—Ä–æ–µ–∫—Ç–µ</h2>
                <p><strong>–•–∏—Ç–∞—Å –¥–ª—è –≤—É–Ω–¥–µ—Ä–∫–∏–Ω–¥–æ–≤</strong> ‚Äî –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è –µ–≤—Ä–µ–π—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤.</p>
                <p>–ú—ã –ø–æ–º–æ–≥–∞–µ–º –¥–µ—Ç—è–º –∏–∑—É—á–∞—Ç—å:</p>
                <ul>
                    <li>üìñ –•—É–º–∞—à (–ù–µ–¥–µ–ª—å–Ω–∞—è –≥–ª–∞–≤–∞)</li>
                    <li>üôè –¢–µ–∏–ª–∏–º (–ü—Å–∞–ª–º—ã)</li>
                    <li>üìò –¢–∞–Ω–∏—è (–•–∞—Å–∏–¥—Å–∫–∞—è —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è)</li>
                    <li>‚òÄÔ∏è Hayom Yom (–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —É—Ä–æ–∫–∏)</li>
                    <li>‚öñÔ∏è –†–∞–º–±–∞–º (–ï–≤—Ä–µ–π—Å–∫–∏–π –∑–∞–∫–æ–Ω)</li>
                    <li>üí° –ì–µ—É–ª–∞ —É-–ú–æ—à–∏–∞—Ö (–û –ø—Ä–∏—Ö–æ–¥–µ –ú–æ—à–∏–∞—Ö–∞)</li>
                </ul>
                <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –¥–ª—è –µ–≤—Ä–µ–π—Å–∫–∏—Ö –¥–µ—Ç–µ–π –≤—Å–µ–≥–æ –º–∏—Ä–∞! üíô</p>
            </div>
        </div>
    </div>

    <div class="view" id="howtoView">
        <div class="container">
            <div class="card">
                <button class="btn" id="backToHelpFromHowto" style="margin-bottom: 15px;">‚Üê –ù–∞–∑–∞–¥</button>
                <h2>üéÆ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å</h2>
                <p><strong>–ö–∞–∂–¥—ã–π –¥–µ–Ω—å:</strong></p>
                <ol>
                    <li>–í—ã–±–µ—Ä–∏ —Ä–∞–∑–¥–µ–ª (–•—É–º–∞—à, –¢–∞–Ω–∏—è –∏ —Ç.–¥.)</li>
                    <li>–ü—Ä–æ—á–∏—Ç–∞–π —É—Ä–æ–∫ –¥–Ω—è</li>
                    <li>–ò–≥—Ä–∞–π –≤ –∏–≥—Ä—ã –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞</li>
                    <li>–ü–æ–ª—É—á–∞–π –∑–≤—ë–∑–¥—ã –∏ –±–∞–ª–ª—ã –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã</li>
                </ol>
                <p><strong>–¢–∏–ø—ã –∏–≥—Ä:</strong></p>
                <ul>
                    <li>üéØ <strong>–í–∏–∫—Ç–æ—Ä–∏–Ω–∞</strong> ‚Äî –≤—ã–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç</li>
                    <li>‚úì <strong>–ü—Ä–∞–≤–¥–∞ –∏–ª–∏ –õ–æ–∂—å</strong> ‚Äî –æ—Ü–µ–Ω–∏ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</li>
                    <li>üîó <strong>–°–æ–µ–¥–∏–Ω–∏ –ø–∞—Ä—ã</strong> ‚Äî –Ω–∞–π–¥–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è</li>
                    <li>üé° <strong>–ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã</strong> ‚Äî –∫—Ä—É—Ç–∏ –∏ –æ—Ç–≤–µ—á–∞–π</li>
                    <li>ü§î <strong>–†–∞–∑–º—ã—à–ª–µ–Ω–∏—è</strong> ‚Äî –Ω–∞–ø–∏—à–∏ —Å–≤–æ–∏ –º—ã—Å–ª–∏</li>
                </ul>
                <p><strong>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π —Å—Ç—Ä–∏–∫!</strong> –£—á–∏—Å—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø–æ–¥—Ä—è–¥ –∏ –ø–æ–ª—É—á–∞–π –æ—Å–æ–±—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è! üî•</p>
            </div>
        </div>
    </div>

    <div class="view" id="privacyView">
        <div class="container">
            <div class="card">
                <button class="btn" id="backToHelpFromPrivacy" style="margin-bottom: 15px;">‚Üê –ù–∞–∑–∞–¥</button>
                <h2>üîí –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</h2>
                <p><strong>–ú—ã —É–≤–∞–∂–∞–µ–º –≤–∞—à—É –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å.</strong></p>
                <p><strong>–°–æ–±–∏—Ä–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:</strong></p>
                <ul>
                    <li>Email (–ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)</li>
                    <li>–ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è (–±–∞–ª–ª—ã, –∑–≤—ë–∑–¥—ã, —Å—Ç—Ä–∏–∫)</li>
                    <li>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</li>
                </ul>
                <p><strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:</strong></p>
                <ul>
                    <li>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</li>
                    <li>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏</li>
                    <li>–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</li>
                </ul>
                <p><strong>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:</strong></p>
                <p>–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—â–∏—â—ë–Ω–Ω–æ–π –±–∞–∑–µ Firebase –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º.</p>
                <p>–ú—ã –ù–ï –ø—Ä–æ–¥–∞—ë–º –∏ –ù–ï –ø–µ—Ä–µ–¥–∞—ë–º –≤–∞—à–∏ –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.</p>
            </div>
        </div>
    </div>

    <div class="view" id="settingsView">
        <div class="container">
            <div class="card setting-item" data-setting="sound">
                <div class="setting-info">
                    <h3>üîä –ó–≤—É–∫</h3>
                    <p>–ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</p>
                </div>
                <div class="toggle-switch active" id="soundToggle"></div>
            </div>
            <div class="card setting-item" data-setting="animations">
                <div class="setting-info">
                    <h3>‚ú® –ê–Ω–∏–º–∞—Ü–∏–∏</h3>
                    <p>–ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã</p>
                </div>
                <div class="toggle-switch active" id="animationsToggle"></div>
            </div>
            <div class="card setting-item" data-setting="darkMode">
                <div class="setting-info">
                    <h3>üåô –¢—ë–º–Ω–∞—è —Ç–µ–º–∞</h3>
                    <p>–†–µ–∂–∏–º –¥–ª—è –≤–µ—á–µ—Ä–∞</p>
                </div>
                <div class="toggle-switch" id="darkModeToggle"></div>
            </div>
            <div class="card setting-item" id="syncProgressBtn">
                <div class="setting-info">
                    <h3>‚òÅÔ∏è –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</h3>
                    <p>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –æ–±–ª–∞–∫–æ</p>
                </div>
            </div>
            <div class="card setting-item" id="loadProgressBtn">
                <div class="setting-info">
                    <h3>üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –æ–±–ª–∞–∫–∞</h3>
                    <p>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</p>
                </div>
            </div>
            <div class="card setting-item" id="printBtn">
                <div class="setting-info">
                    <h3>üñ®Ô∏è –ü–µ—á–∞—Ç—å</h3>
                    <p>–†–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã</p>
                </div>
            </div>
            <div class="card setting-item" id="resetBtn">
                <div class="setting-info">
                    <h3>üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</h3>
                    <p>–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</p>
                </div>
            </div>
        </div>
    </div>

    <div class="section-view" id="sectionView">
        <div class="section-header">
            <button class="btn" id="closeSectionBtn">‚Üê –ù–∞–∑–∞–¥</button>
            <h2 id="sectionTitle">–†–∞–∑–¥–µ–ª</h2>
            <button class="btn" id="speakBtn">üîä</button>
        </div>
        <div class="section-content" id="sectionContent"></div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" data-view="homeView">
            <div class="nav-icon">üè†</div>
            <div class="nav-label">–ì–ª–∞–≤–Ω–∞—è</div>
        </div>
        <div class="nav-item" data-view="profileView">
            <div class="nav-icon">üë§</div>
            <div class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</div>
        </div>
        <div class="nav-item" data-view="helpView">
            <div class="nav-icon">‚ùì</div>
            <div class="nav-label">–ü–æ–º–æ—â—å</div>
        </div>
        <div class="nav-item" data-view="settingsView">
            <div class="nav-icon">‚öôÔ∏è</div>
            <div class="nav-label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
        </div>
    </nav>

    <!-- Auth Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeAuthModal()">&times;</span>
            <h2 id="modalTitle">–í—Ö–æ–¥</h2>
            <div id="modalError" class="modal-error"></div>

            <!-- Sign In Form -->
            <div id="signInForm">
                <input type="email" id="emailInput" placeholder="Email" class="modal-input">
                <input type="password" id="passwordInput" placeholder="–ü–∞—Ä–æ–ª—å" class="modal-input">
                <button onclick="handleEmailSignIn(event)" class="modal-btn primary">–í–æ–π—Ç–∏</button>
                <button onclick="handleGoogleSignIn(event)" class="modal-btn google">
                    <span>üîê</span> –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
                </button>
                <div class="modal-links">
                    <a href="#" onclick="showResetPassword(); return false;">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a>
                    <a href="#" onclick="showSignUpForm(); return false;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                </div>
            </div>

            <!-- Sign Up Form -->
            <div id="signUpForm" style="display:none;">
                <input type="text" id="nameInput" placeholder="–ò–º—è" class="modal-input">
                <input type="email" id="signUpEmail" placeholder="Email" class="modal-input">
                <input type="password" id="signUpPassword" placeholder="–ü–∞—Ä–æ–ª—å (–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)" class="modal-input">
                <button onclick="handleEmailSignUp(event)" class="modal-btn primary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <div class="modal-links">
                    <a href="#" onclick="showSignInForm(); return false;">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏</a>
                </div>
            </div>

            <!-- Reset Password Form -->
            <div id="resetPasswordForm" style="display:none;">
                <input type="email" id="resetEmail" placeholder="Email" class="modal-input">
                <button onclick="handlePasswordReset(event)" class="modal-btn primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É</button>
                <div class="modal-links">
                    <a href="#" onclick="showSignInForm(); return false;">–ù–∞–∑–∞–¥ –∫–æ –≤—Ö–æ–¥—É</a>
                </div>
            </div>
        </div>
    </div>

    <!-- ResponsiveVoice API - Free Non-Commercial License -->
    <!-- To get your own API key, visit: https://responsivevoice.org/register/ -->
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=fJJxVj8T"></script>

    <!-- ResponsiveVoice Initialization Handler -->
    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ResponsiveVoice
        let rvCheckCount = 0;
        const maxChecks = 50; // 5 —Å–µ–∫—É–Ω–¥ –º–∞–∫—Å–∏–º—É–º
        let audioPermissionGranted = false;

        function checkResponsiveVoice() {
            rvCheckCount++;

            if (window.responsiveVoice) {
                console.log('‚úÖ ResponsiveVoice loaded successfully!');
                console.log('üìä ResponsiveVoice info:', {
                    version: responsiveVoice.version || 'unknown',
                    voiceSupport: responsiveVoice.voiceSupport(),
                    voices: responsiveVoice.getVoices().length
                });

                // –í—ã–≤–æ–¥–∏–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ä—É—Å—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞
                const russianVoices = responsiveVoice.getVoices().filter(v =>
                    v.name.includes('Russian') || v.lang.includes('ru')
                );
                console.log('üé§ Russian voices available:', russianVoices.map(v => v.name));

                // –£–≤–µ–¥–æ–º–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if (responsiveVoice.voiceSupport()) {
                    console.log('üîä –û–∑–≤—É—á–∫–∞ –≥–æ—Ç–æ–≤–∞! ResponsiveVoice —Ä–∞–±–æ—Ç–∞–µ—Ç.');
                } else {
                    console.warn('‚ö†Ô∏è ResponsiveVoice –∑–∞–≥—Ä—É–∂–µ–Ω, –Ω–æ –≥–æ–ª–æ—Å–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞');
                }
            } else if (rvCheckCount < maxChecks) {
                // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å
                setTimeout(checkResponsiveVoice, 100);
            } else {
                console.error('‚ùå ResponsiveVoice –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è –ø–æ—Å–ª–µ ' + (maxChecks * 100 / 1000) + ' —Å–µ–∫—É–Ω–¥');
                console.log('‚ÑπÔ∏è –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Web Speech API');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—É–¥–∏–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
        async function initializeAudioPermissions() {
            if (audioPermissionGranted) return true;

            console.log('üîä –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π...');

            try {
                // 1. –ü–æ–ø—ã—Ç–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ HTML5 audio —ç–ª–µ–º–µ–Ω—Ç
                // –≠—Ç–æ –≤—ã–∑–æ–≤–µ—Ç –ø–æ—è–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∑–≤—É–∫–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞
                const audioElement = document.getElementById('audioPermissionTrigger');
                if (audioElement) {
                    audioElement.volume = 0.01; // –û—á–µ–Ω—å —Ç–∏—Ö–∏–π –∑–≤—É–∫
                    try {
                        const playPromise = audioElement.play();
                        if (playPromise !== undefined) {
                            await playPromise;
                            console.log('‚úÖ HTML5 Audio –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω');
                            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
                            audioElement.pause();
                            audioElement.currentTime = 0;
                        }
                    } catch (playError) {
                        console.log('‚ÑπÔ∏è HTML5 Audio —Ç—Ä–µ–±—É–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', playError.message);
                    }
                }

                // 2. –°–æ–∑–¥–∞–µ–º AudioContext –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                if (AudioContext) {
                    const audioContext = new AudioContext();

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
                    if (audioContext.state === 'suspended') {
                        await audioContext.resume();
                    }

                    console.log('üîä –ê—É–¥–∏–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω:', audioContext.state);
                    audioPermissionGranted = true;

                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç, –æ–Ω –Ω–∞–º –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω
                    audioContext.close();
                    return true;
                }
            } catch (error) {
                console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—É–¥–∏–æ:', error);
            }

            // 3. Fallback: –ø—Ä–æ–±—É–µ–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Ç–∏—Ö–∏–π –∑–≤—É–∫ —á–µ—Ä–µ–∑ ResponsiveVoice/WebSpeech
            try {
                if (window.responsiveVoice) {
                    // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–∏—Ö–∏–π –∑–≤—É–∫
                    responsiveVoice.speak('', 'Russian Female', {
                        volume: 0,
                        onend: () => {
                            console.log('üîä –ê—É–¥–∏–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω—ã —á–µ—Ä–µ–∑ ResponsiveVoice');
                            audioPermissionGranted = true;
                        }
                    });
                } else if (window.speechSynthesis) {
                    const utterance = new SpeechSynthesisUtterance('');
                    utterance.volume = 0;
                    window.speechSynthesis.speak(utterance);
                    audioPermissionGranted = true;
                    console.log('üîä –ê—É–¥–∏–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω—ã —á–µ—Ä–µ–∑ Web Speech API');
                }
            } catch (error) {
                console.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∞—É–¥–∏–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:', error);
            }

            return audioPermissionGranted;
        }

        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –æ–∑–≤—É—á–∫–æ–π
        window.requestAudioPermission = initializeAudioPermissions;

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∫–ª–∏–∫–µ
        let firstInteraction = true;
        document.addEventListener('click', async function handleFirstClick() {
            if (firstInteraction) {
                firstInteraction = false;
                console.log('üëÜ –ü–µ—Ä–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ');
                await initializeAudioPermissions();
            }
        }, { once: false });

        // –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', checkResponsiveVoice);
        } else {
            checkResponsiveVoice();
        }
    </script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Firebase Config and Auth -->
    <script src="firebase-config.js"></script>
    <script src="auth-manager.js"></script>
    <script src="auth-ui.js"></script>

    <!-- Audio Reader -->
    <script src="audio-reader.js"></script>

    <!-- Confetti.js –¥–ª—è –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Games -->
    <script src="games/quiz.js"></script>
    <script src="games/truefalse.js"></script>
    <script src="games/match.js"></script>
    <script src="games/reflection.js"></script>
    <script src="games/wheel.js"></script>

    <!-- Achievements Manager -->
    <script src="achievements-manager.js"></script>

    <!-- Print Manager -->
    <script src="print-manager.js"></script>

    <!-- Main App -->
    <script src="app.js"></script>
</body>
</html>
